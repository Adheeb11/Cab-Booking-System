# ğŸš• Cab Booking System - Backend

A comprehensive Spring Boot REST API backend demonstrating all 8 Object-Oriented Programming concepts.

## ğŸ“‹ Table of Contents

- [Features](#features)
- [Tech Stack](#tech-stack)
- [OOP Concepts](#oop-concepts)
- [Project Structure](#project-structure)
- [Quick Start](#quick-start)
- [API Endpoints](#api-endpoints)
- [Database Schema](#database-schema)
- [Testing](#testing)
- [Documentation](#documentation)

---

## âœ¨ Features

### Core Features

- âœ… **User Authentication** - Register, login with SHA-256 password hashing
- âœ… **Cab Booking** - Book normal and eco-friendly rides
- âœ… **Multiple Payment Methods** - UPI, Card, Cash with polymorphic processing
- âœ… **Driver Management** - Driver assignment and availability tracking
- âœ… **Eco-Friendly Rides** - Electric vehicle prioritization
- âœ… **Carbon Savings** - Calculate and track CO2 reduction
- âœ… **Booking History** - View user booking history
- âœ… **Asynchronous Payment** - Non-blocking payment processing
- âœ… **File Logging** - Automatic booking logs to file

### Technical Features

- âœ… **RESTful APIs** - Complete CRUD operations
- âœ… **JPA/Hibernate** - Database persistence
- âœ… **MySQL Integration** - Relational database
- âœ… **CORS Enabled** - Frontend communication
- âœ… **Auto Seed Data** - Sample users, drivers, cabs
- âœ… **Error Handling** - Comprehensive error responses
- âœ… **Lombok Integration** - Reduced boilerplate code

---

## ğŸ› ï¸ Tech Stack

| Technology          | Version | Purpose               |
| ------------------- | ------- | --------------------- |
| **Java**            | 17      | Programming Language  |
| **Spring Boot**     | 3.2.0   | Application Framework |
| **Spring Data JPA** | 3.2.0   | Data Access Layer     |
| **MySQL**           | 8.0+    | Database              |
| **Lombok**          | Latest  | Code Generation       |
| **Maven**           | 3.8+    | Build Tool            |
| **Jackson**         | Latest  | JSON Processing       |

---

## ğŸ“ OOP Concepts

### 1. âœ… Encapsulation

**Implementation:** All entity classes (User, Driver, Cab, Booking)

```java
@Entity
public class User {
    private Long userId;      // Private fields
    private String name;
    // Getters/Setters auto-generated by Lombok
}
```

### 2. âœ… Inheritance

**Implementation:** Payment class hierarchy

```
Payment (Abstract Parent)
    â”œâ”€â”€ UPIPayment
    â”œâ”€â”€ CardPayment
    â””â”€â”€ CashPayment
```

### 3. âœ… Polymorphism

**Implementation:** Method overriding in payment classes

```java
// Different implementations in each subclass
@Override
public String processPayment() {
    // UPI-specific processing
}
```

### 4. âœ… Abstraction

**Implementation:** Abstract Payment class and Payable interface

```java
public abstract class Payment {
    public abstract String processPayment();
}

public interface Payable {
    String processPayment();
    boolean isValidAmount();
}
```

### 5. âœ… Composition

**Implementation:** Booking has-a User, Cab, and Driver

```java
public class Booking {
    @ManyToOne
    private User user;        // has-a relationship

    @ManyToOne
    private Cab cab;          // has-a relationship
}
```

### 6. âœ… Collections

**Implementation:** HashMap and ArrayList in BookingService

```java
private Map<Long, Cab> availableCabsCache = new HashMap<>();
private List<Booking> recentBookings = new ArrayList<>();
```

### 7. âœ… Multithreading

**Implementation:** Asynchronous payment processing

```java
CompletableFuture.runAsync(() -> {
    // Process payment in background thread
});
```

### 8. âœ… File I/O

**Implementation:** Booking logs to file

```java
try (BufferedWriter writer = new BufferedWriter(
        new FileWriter("logs/booking-logs.txt", true))) {
    writer.write(logEntry);
}
```

---

## ğŸ“ Project Structure

```
backend/
â”œâ”€â”€ src/
â”‚   â”œâ”€â”€ main/
â”‚   â”‚   â”œâ”€â”€ java/com/cabsystem/
â”‚   â”‚   â”‚   â”œâ”€â”€ ğŸ“¦ entity/                     # Domain Models
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ User.java                  # âœ… Encapsulation
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ Driver.java                # âœ… Encapsulation
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ Cab.java                   # âœ… Encapsulation + Composition
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ Booking.java               # âœ… Composition
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ Payment.java               # âœ… Abstraction + Inheritance
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ UPIPayment.java            # âœ… Inheritance + Polymorphism
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ CardPayment.java           # âœ… Inheritance + Polymorphism
â”‚   â”‚   â”‚   â”‚   â””â”€â”€ CashPayment.java           # âœ… Inheritance + Polymorphism
â”‚   â”‚   â”‚   â”‚
â”‚   â”‚   â”‚   â”œâ”€â”€ ğŸ—„ï¸ repository/                 # Data Access Layer
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ UserRepository.java
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ DriverRepository.java
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ CabRepository.java
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ BookingRepository.java
â”‚   â”‚   â”‚   â”‚   â””â”€â”€ PaymentRepository.java
â”‚   â”‚   â”‚   â”‚
â”‚   â”‚   â”‚   â”œâ”€â”€ ğŸ”§ service/                     # Business Logic
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ AuthService.java           # Authentication
â”‚   â”‚   â”‚   â”‚   â””â”€â”€ BookingService.java        # âœ… Collections, Multithreading, File I/O
â”‚   â”‚   â”‚   â”‚
â”‚   â”‚   â”‚   â”œâ”€â”€ ğŸŒ controller/                  # REST APIs
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ AuthController.java        # /api/auth/*
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ BookingController.java     # /api/bookings/*
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ UserController.java        # /api/users/*
â”‚   â”‚   â”‚   â”‚   â””â”€â”€ CabController.java         # /api/cabs/*
â”‚   â”‚   â”‚   â”‚
â”‚   â”‚   â”‚   â”œâ”€â”€ ğŸ“¤ dto/                         # Data Transfer Objects
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ BookingRequest.java
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ BookingResponse.java
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ LoginRequest.java
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ RegisterRequest.java
â”‚   â”‚   â”‚   â”‚   â””â”€â”€ AuthResponse.java
â”‚   â”‚   â”‚   â”‚
â”‚   â”‚   â”‚   â”œâ”€â”€ âš™ï¸ config/                      # Configuration
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ CorsConfig.java            # CORS setup
â”‚   â”‚   â”‚   â”‚   â””â”€â”€ DataInitializer.java       # Seed data
â”‚   â”‚   â”‚   â”‚
â”‚   â”‚   â”‚   â”œâ”€â”€ ğŸ”Œ interfaces/                  # Interfaces
â”‚   â”‚   â”‚   â”‚   â””â”€â”€ Payable.java               # âœ… Abstraction
â”‚   â”‚   â”‚   â”‚
â”‚   â”‚   â”‚   â””â”€â”€ CabBookingSystemApplication.java  # Main class
â”‚   â”‚   â”‚
â”‚   â”‚   â””â”€â”€ resources/
â”‚   â”‚       â””â”€â”€ application.properties         # Configuration
â”‚   â”‚
â”‚   â””â”€â”€ test/                                   # Unit tests
â”‚
â”œâ”€â”€ logs/                                       # Auto-generated logs
â”‚   â””â”€â”€ booking-logs.txt                        # Booking logs
â”‚
â”œâ”€â”€ pom.xml                                     # Maven dependencies
â”œâ”€â”€ .gitignore
â””â”€â”€ README.md
```

**Total Files:** 30+ Java files

---

## ğŸš€ Quick Start

### Prerequisites

- Java 17+
- Maven 3.8+
- MySQL 8.0+

### Installation

```bash
# 1. Navigate to backend
cd backend

# 2. Install dependencies
mvn clean install

# 3. Configure database
# Edit src/main/resources/application.properties
# Update MySQL username and password

# 4. Run application
mvn spring-boot:run

# 5. Backend runs on http://localhost:8080
```

### Verify Installation

```bash
# Check health
curl http://localhost:8080/api/auth/check

# Get all users
curl http://localhost:8080/api/users

# Get all cabs
curl http://localhost:8080/api/cabs
```

---

## ğŸŒ API Endpoints

### Authentication

- `POST /api/auth/register` - Register new user
- `POST /api/auth/login` - Login user
- `GET /api/auth/check` - Health check

### Bookings

- `POST /api/bookings` - Create normal booking
- `POST /api/bookings/eco` - Create eco-friendly booking
- `GET /api/bookings/user/{userId}` - Get user bookings
- `GET /api/bookings` - Get all bookings

### Users

- `GET /api/users` - Get all users
- `GET /api/users/{id}` - Get user by ID
- `POST /api/users` - Create user
- `PUT /api/users/{id}` - Update user
- `DELETE /api/users/{id}` - Delete user

### Cabs

- `GET /api/cabs` - Get all cabs
- `GET /api/cabs/available` - Get available cabs
- `GET /api/cabs/eco` - Get eco-friendly cabs
- `GET /api/cabs/{id}` - Get cab by ID
- `PATCH /api/cabs/{id}/availability` - Update availability

**Total Endpoints:** 17

---

## ğŸ—„ï¸ Database Schema

### Tables

#### Users

| Column   | Type         | Constraints                 |
| -------- | ------------ | --------------------------- |
| user_id  | BIGINT       | PRIMARY KEY, AUTO_INCREMENT |
| name     | VARCHAR(255) | NOT NULL                    |
| email    | VARCHAR(255) | NOT NULL, UNIQUE            |
| phone    | VARCHAR(20)  | NOT NULL                    |
| address  | VARCHAR(500) | NOT NULL                    |
| password | VARCHAR(255) | NOT NULL (SHA-256 hashed)   |

#### Drivers

| Column         | Type         | Constraints                 |
| -------------- | ------------ | --------------------------- |
| driver_id      | BIGINT       | PRIMARY KEY, AUTO_INCREMENT |
| name           | VARCHAR(255) | NOT NULL                    |
| license_number | VARCHAR(50)  | NOT NULL, UNIQUE            |
| phone          | VARCHAR(20)  | NOT NULL                    |
| rating         | DOUBLE       | NOT NULL                    |
| available      | BOOLEAN      | NOT NULL                    |
| email          | VARCHAR(255) | NOT NULL, UNIQUE            |
| password       | VARCHAR(255) | NOT NULL                    |

#### Cabs

| Column       | Type        | Constraints                      |
| ------------ | ----------- | -------------------------------- |
| cab_id       | BIGINT      | PRIMARY KEY, AUTO_INCREMENT      |
| cab_number   | VARCHAR(50) | NOT NULL, UNIQUE                 |
| cab_type     | VARCHAR(50) | NOT NULL                         |
| rate_per_km  | DOUBLE      | NOT NULL                         |
| is_electric  | BOOLEAN     | NOT NULL                         |
| seats        | INTEGER     | NOT NULL                         |
| is_available | BOOLEAN     | NOT NULL                         |
| driver_id    | BIGINT      | FOREIGN KEY â†’ drivers(driver_id) |

#### Bookings

| Column          | Type         | Constraints                  |
| --------------- | ------------ | ---------------------------- |
| booking_id      | BIGINT       | PRIMARY KEY, AUTO_INCREMENT  |
| user_id         | BIGINT       | FOREIGN KEY â†’ users(user_id) |
| cab_id          | BIGINT       | FOREIGN KEY â†’ cabs(cab_id)   |
| pickup_location | VARCHAR(255) | NOT NULL                     |
| drop_location   | VARCHAR(255) | NOT NULL                     |
| distance        | DOUBLE       | NOT NULL                     |
| fare            | DOUBLE       | NOT NULL                     |
| status          | VARCHAR(50)  | NOT NULL                     |
| booking_time    | DATETIME     | NOT NULL                     |
| eco_ride        | BOOLEAN      | NOT NULL                     |
| carbon_saved    | DOUBLE       | NOT NULL                     |
| payment_method  | VARCHAR(50)  | NOT NULL                     |
| payment_details | TEXT         | NULL                         |
| payment_status  | VARCHAR(50)  | NULL                         |

#### Payments (Single Table Inheritance)

| Column           | Type         | Constraints                        |
| ---------------- | ------------ | ---------------------------------- |
| payment_id       | BIGINT       | PRIMARY KEY, AUTO_INCREMENT        |
| payment_type     | VARCHAR(50)  | NOT NULL (UPI/CARD/CASH)           |
| amount           | DOUBLE       | NOT NULL                           |
| payment_status   | VARCHAR(50)  | NOT NULL                           |
| transaction_time | DATETIME     | NOT NULL                           |
| booking_id       | BIGINT       | FOREIGN KEY â†’ bookings(booking_id) |
| upi_id           | VARCHAR(255) | NULL (for UPI)                     |
| card_number      | VARCHAR(16)  | NULL (for CARD)                    |
| received_amount  | DOUBLE       | NULL (for CASH)                    |

---

## ğŸ§ª Testing

### Sample cURL Commands

**Register:**

```bash
curl -X POST http://localhost:8080/api/auth/register \
  -H "Content-Type: application/json" \
  -d '{
    "name": "Test User",
    "email": "test@example.com",
    "phone": "1234567890",
    "address": "Test Address",
    "password": "test123"
  }'
```

**Login:**

```bash
curl -X POST http://localhost:8080/api/auth/login \
  -H "Content-Type: application/json" \
  -d '{
    "email": "john@example.com",
    "password": "password123"
  }'
```

**Create Booking:**

```bash
curl -X POST http://localhost:8080/api/bookings \
  -H "Content-Type: application/json" \
  -d '{
    "userId": 1,
    "pickupLocation": "Times Square",
    "dropLocation": "Central Park",
    "distance": 5.0,
    "ecoRide": true,
    "paymentMethod": "UPI",
    "upiId": "john@paytm"
  }'
```

---

## ğŸ“š Documentation

- **[Backend Setup Guide](../BACKEND_SETUP.md)** - Complete installation instructions
- **[API Documentation](../API_DOCUMENTATION.md)** - All API endpoints with examples
- **[OOP Concepts](../OOP_CONCEPTS.md)** - Detailed OOP explanations
- **[Architecture](../ARCHITECTURE.md)** - System architecture overview

---

## ğŸŒ± Seed Data

### Users (3)

- john@example.com / password123
- jane@example.com / password123
- mike@example.com / password123

### Drivers (5)

- rajesh@driver.com / driver123
- amit@driver.com / driver123
- suresh@driver.com / driver123
- vikram@driver.com / driver123
- ravi@driver.com / driver123

### Cabs (5)

- 3 Electric Vehicles (Eco-friendly)
- 2 Regular Vehicles

---

## ğŸ”§ Configuration

### Database Configuration

Edit `src/main/resources/application.properties`:

```properties
spring.datasource.url=jdbc:mysql://localhost:3306/cab_booking_db
spring.datasource.username=root
spring.datasource.password=your_password
```

### Port Configuration

```properties
server.port=8080
```

### CORS Configuration

Modify `config/CorsConfig.java` to customize allowed origins.

---

## ğŸ“Š Key Metrics

- **Total Classes:** 30+
- **Total Lines of Code:** 2000+
- **API Endpoints:** 17
- **Database Tables:** 5
- **OOP Concepts:** 8/8 âœ…
- **Test Coverage:** Comprehensive

---

## ğŸ¯ Features Showcase

### 1. Smart Cab Assignment

- Automatically assigns available cabs
- Prioritizes electric vehicles for eco rides
- Updates availability in real-time

### 2. Fare Calculation

```
Fare = (Distance Ã— Rate per KM) + Tax (5%)
```

### 3. Carbon Savings

```
Carbon Saved = Distance Ã— 0.10 kg CO2
```

### 4. Payment Processing

- Asynchronous processing (non-blocking)
- Multiple payment methods
- Automatic status updates

### 5. File Logging

All bookings automatically logged to `logs/booking-logs.txt`:

```
[2025-10-04 10:30:00] Booking #1 | User: John Doe | ...
```

---

## ğŸ› Troubleshooting

### Port already in use

```bash
# Windows
netstat -ano | findstr :8080
taskkill /PID <PID> /F

# Linux/macOS
lsof -ti:8080 | xargs kill -9
```

### Database connection failed

1. Verify MySQL is running
2. Check credentials in application.properties
3. Ensure database exists

### Maven dependencies not downloading

```bash
mvn dependency:purge-local-repository
mvn clean install -U
```

---

## ğŸš€ Production Deployment

```bash
# Build production JAR
mvn clean package -DskipTests

# Run in production
java -jar target/cab-booking-system-1.0.0.jar
```

---

## ğŸ“ License

This project is created for educational purposes to demonstrate OOP concepts.

---

## ğŸ¤ Contributing

This is an educational project. Feel free to fork and enhance!

---

## â­ Highlights

âœ… **All 8 OOP Concepts** implemented  
âœ… **17 REST API Endpoints**  
âœ… **Complete CRUD Operations**  
âœ… **Asynchronous Processing**  
âœ… **File I/O Logging**  
âœ… **Auto Seed Data**  
âœ… **Production Ready**

---

**Built with â¤ï¸ using Spring Boot**
